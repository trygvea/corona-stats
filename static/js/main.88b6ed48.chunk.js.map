{"version":3,"sources":["utils/fetch-util.js","types/Corona.ts","utils/number-util.ts","data/population.ts","pages/PerCountryPageLoader.tsx","utils/array-util.ts","utils/string-util.ts","hooks/hover.js","components/MinigraphHover.tsx","utils/date-util.ts","components/MinigraphBar.tsx","components/Minigraph.tsx","components/ProgressBar.tsx","components/CountryHover.tsx","components/PerCountryTableRow.tsx","components/PerCountryTable.tsx","components/SearchPropsForm.tsx","pages/PerCountryPage.tsx","App.tsx","serviceWorker.ts","index.tsx"],"names":["verify","res","ok","contentType","headers","get","indexOf","json","then","Promise","reject","Error","statusText","resolve","toJson","toCsv","text","rows","split","map","row","EmptyTimeline","values","maxValue","total","accumulateTotals","reduce","acc","val","i","push","value","sum","arr","agg","v","formatCompact","n","Intl","NumberFormat","notation","compactDisplay","format","populationUrl","ALTERNATE_COUNTRY_NAMES","Brunei","Bahamas","Congo","Egypt","Eritrea","Gambia","Iran","Kyrgyzstan","Laos","Macedonia","Russia","Slovakia","Syria","Timor","Venezuela","lastYearsPopulation","worldPopulation","country","lastYearKey","Object","keys","slice","Country","population","a","fetch","urls","transformCovidCases","csv","firstRow","data","countries","rowsWithData","filter","length","_","c","r","dates","valuesPerCountry","stringValue","parseInt","countryName","date","j","Math","max","mergeData","populationData","newDeaths","newCases","decorated","countryDeaths","_findPop","find","alternateName","undefined","findPopulation","countryCases","name","deaths","totalPerCapita","cases","merged","countriesWithoutPopulation","console","warn","verifyPopulation","usePageLoader","useState","setPopulationData","setNewDeaths","setNewCases","useEffect","fetchWorldPopulation","useMemo","useHover","setValue","handleMouseOver","useCallback","handleMouseOut","ref","useRef","node","current","removeEventListener","addEventListener","MinigraphHover","className","toFormat","formatDate","DateTime","fromISO","formatDateISO","MinigraphBar","barBorder","barRef","isHovered","key","title","style","marginRight","height","Minigraph","timeline","prefixText","graphClass","lastValue","graphWidth","width","ProgressBar","progress","CountryHover","PerCountryTableRow","maxDeathsPerCapita","rowRef","searchProps","useContext","PerCountryPageContext","deathsTotal","casesTotal","numCols","numHistoryDays","round","showCasesTotal","showCasesNew","showDeathsTotal","showDeathsNew","PerCountryTable","countryData","countryFilter","hideTinyCountries","tinyCountryLimit","countrySorter","b","showWorldFirst","Number","MIN_SAFE_INTEGER","MAX_SAFE_INTEGER","sort","SearchPropsDefault","SearchPropsForm","updateSearchProps","onCloseDrawer","updateProp","prop","Item","label","checked","onChange","disabled","min","tipFormatter","type","onClick","React","createContext","PerCountryPage","drawerVisible","setDrawerVisible","setSearchProps","lastLoaded","Provider","href","target","rel","src","alt","placement","closable","onClose","visible","App","path","Boolean","window","location","hostname","match","ReactDOM","render","StrictMode","document","getElementById","navigator","serviceWorker","ready","registration","unregister","catch","error","message"],"mappings":"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","file":"static/js/main.88b6ed48.chunk.js","sourcesContent":["export const verify = res => {\n    if (!res.ok) {\n        const contentType = res.headers.get('content-type')\n        if (contentType?.indexOf('application/json') !== -1) {\n            return res.json().then(\n                json => {\n                    return Promise.reject(new Error(res.statusText))\n                },\n                () => Promise.reject(new Error(res.statusText))\n            )\n        }\n        return Promise.reject(new Error(res.statusText))\n    }\n    return Promise.resolve(res)\n}\n\nexport const toJson = res => {\n    return verify(res).then(res => res.json())\n}\n\nexport const toCsv = res => {\n    return verify(res).then(res => res.text()).then(rows => rows.split('\\n').map(row => row.split(',')))\n}\n","import { Integer, ISODate } from './Types'\n\nexport interface Population {\n    country: string\n    population: Integer\n    year: Integer\n}\n\nexport interface TimelineEntry {\n    date: ISODate\n    value: number\n}\n\nexport interface Timeline {\n    values: TimelineEntry[]\n    maxValue: number\n    total: number\n}\n\nexport interface LoadedTimeline extends Timeline {\n    countryName: string\n}\n\nexport interface PopulationTimeline extends Timeline {\n    totalPerCapita: number\n}\n\nexport interface CountryData {\n    name: string\n    population?: Integer\n    deaths: PopulationTimeline\n    cases: PopulationTimeline\n}\n\nexport const EmptyTimeline: Timeline = {\n    values: [],\n    maxValue: 0,\n    total: 0,\n}\n\nexport const accumulateTotals = (values: TimelineEntry[]): TimelineEntry[] =>\n    values.reduce<TimelineEntry[]>((acc, val, i) => {\n        if (i === 0) {\n            acc.push(val)\n        } else {\n            acc.push({ ...val, value: acc[i - 1].value + val.value })\n        }\n        return acc\n    }, [])\n","import { Integer } from '../types/Types'\n\nexport const sum = (arr: number[]): number => arr.reduce((agg, v) => (agg += v), 0)\n\nexport const formatCompact = (n?: Integer): string => {\n    if (!n) {\n        return 'unknown'\n    }\n    // @ts-ignore\n    return new Intl.NumberFormat('en-GB', { notation: 'compact', compactDisplay: 'short' }).format(n)\n}\n","import { toJson } from '../utils/fetch-util'\nimport { Population } from '../types/Corona'\n\n// NOTE: This service seems to have political issues. For instance it seems to have noe entries for Palestine or Taiwan.\n\n// https://datahub.io/JohnSnowLabs/population-figures-by-country\nconst populationUrl =\n    'https://pkgstore.datahub.io/JohnSnowLabs/population-figures-by-country/population-figures-by-country-csv_json/data/2159fad77778c3b584f3d396593e0af6/population-figures-by-country-csv_json.json'\n\nconst ALTERNATE_COUNTRY_NAMES: { [key: string]: string } = {\n    Brunei: 'Brunei Darussalam',\n    Bahamas: 'Bahamas, The',\n    Congo: 'Congo, Rep.',\n    'Cape Verde': 'Cabo Verde',\n    'Democratic Republic of Congo': 'Congo, Dem. Rep.',\n    Egypt: 'Egypt, Arab Rep.',\n    Eritrea: 'Eritrea',\n    'Faeroe Islands': 'Faroe Islands',\n    Gambia: 'Gambia, The',\n    Iran: 'Iran, Islamic Rep.',\n    Kyrgyzstan: 'Kyrgyz Republic',\n    Laos: 'Lao PDR',\n    Macedonia: 'Macedonia, FYR',\n    Russia: 'Russian Federation',\n    'Saint Kitts and Nevis': 'St. Kitts and Nevis',\n    'Saint Lucia': 'St. Lucia',\n    'Saint Vincent and the Grenadines': 'St. Vincent and the Grenadines',\n    Slovakia: 'Slovak Republic',\n    'South Korea': 'Korea, Dem. Peopleâ€™s Rep.',\n    Syria: 'Syrian Arab Republic',\n    Timor: 'Timor-Leste',\n    Venezuela: 'Venezuela, RB',\n    'United States Virgin Islands': 'Virgin Islands (U.S.)',\n}\n\n/**\n * Transform world population from weird json struct to local data structure\n */\nconst lastYearsPopulation = (worldPopulation: any): Population[] =>\n    worldPopulation.map((country: any) => {\n        const lastYearKey = Object.keys(country).slice(-1)[0]\n        return {\n            country: country.Country,\n            population: country[lastYearKey],\n        }\n    })\n\nexport async function fetchWorldPopulation(): Promise<Population[]> {\n    return fetch(populationUrl).then(toJson).then(lastYearsPopulation)\n}\n\nexport const findPopulation = (countryName: string, populationData: Population[]): Population | undefined => {\n    const _findPop = (countryName: string) => populationData.find(({ country }) => country === countryName)\n    const population = _findPop(countryName)\n    if (population) {\n        return population\n    }\n    const alternateName = ALTERNATE_COUNTRY_NAMES[countryName]\n    return alternateName ? _findPop(alternateName) : undefined\n}\n","import { useEffect, useMemo, useState } from 'react'\nimport './PerCountryPage.scss'\nimport { toCsv } from '../utils/fetch-util'\nimport { Population, CountryData, LoadedTimeline, EmptyTimeline } from '../types/Corona'\nimport { transpose } from '../utils/array-util'\nimport { sum } from '../utils/number-util'\nimport { toNumberOrZero } from '../utils/string-util'\nimport { fetchWorldPopulation, findPopulation } from '../data/population'\n\nconst urls = {\n    populationPerCountry:\n        'https://pkgstore.datahub.io/JohnSnowLabs/population-figures-by-country/population-figures-by-country-csv_json/data/2159fad77778c3b584f3d396593e0af6/population-figures-by-country-csv_json.json',\n    covidNewDeaths: 'https://covid.ourworldindata.org/data/ecdc/new_deaths.csv',\n    covidNewCases: 'https://covid.ourworldindata.org/data/ecdc/new_cases.csv',\n}\n\n/**\n * Transform corona data from csv file to local data structure\n */\nconst transformCovidCases = (csv: string[][]): LoadedTimeline[] => {\n    const [firstRow, ...data] = csv\n    const [, ...countries] = firstRow\n    const rowsWithData = data.filter((row) => row.length > 1)\n    const [dates, ...valuesPerCountry] = transpose(rowsWithData)\n\n    return countries\n        .map((country, i) => {\n            const values = valuesPerCountry[i].map((stringValue) => toNumberOrZero(stringValue))\n            return {\n                countryName: country,\n                values: dates.map((date, j) => ({\n                    date,\n                    value: values[j],\n                })),\n                maxValue: Math.max(...values),\n                total: sum(values),\n            }\n        })\n        .filter((c) => c.maxValue > 0)\n}\n\nconst verifyPopulation = (merged: CountryData[], populationData: Population[]): void => {\n    const countriesWithoutPopulation = merged.filter((c) => !c.population)\n    if (countriesWithoutPopulation.length > 0) {\n        console.warn(\n            'No population found for the following countries:',\n            countriesWithoutPopulation.map((c) => c.name)\n        )\n        // console.warn(\n        //     'You can fix this problem by making a mapping to one of theses:',\n        //     populationData.map((c) => c.country)\n        // )\n    }\n}\n\nconst mergeData = (\n    populationData: Population[],\n    newDeaths: LoadedTimeline[],\n    newCases: LoadedTimeline[]\n): CountryData[] => {\n    const decorated = newDeaths.map((countryDeaths) => {\n        const population = findPopulation(countryDeaths.countryName, populationData)\n        const countryCases = newCases.find((c) => c.countryName === countryDeaths.countryName) || EmptyTimeline\n        return {\n            population: population?.population,\n            name: countryDeaths.countryName,\n            deaths: {\n                ...countryDeaths,\n                totalPerCapita: population?.population ? countryDeaths.total / population.population : 0,\n            },\n            cases: {\n                ...countryCases,\n                totalPerCapita: population?.population ? (countryCases?.total || 0) / population.population : 0,\n            },\n        }\n    })\n    verifyPopulation(decorated, populationData)\n    return decorated\n}\n\nexport const usePageLoader = (): CountryData[] => {\n    const [populationData, setPopulationData] = useState<Population[]>([])\n    const [newDeaths, setNewDeaths] = useState<LoadedTimeline[]>([])\n    const [newCases, setNewCases] = useState<LoadedTimeline[]>([])\n\n    useEffect(() => {\n        fetchWorldPopulation().then(setPopulationData)\n    }, [])\n\n    useEffect(() => {\n        fetch(urls.covidNewDeaths).then(toCsv).then(transformCovidCases).then(setNewDeaths)\n    }, [])\n\n    useEffect(() => {\n        fetch(urls.covidNewCases).then(toCsv).then(transformCovidCases).then(setNewCases)\n    }, [])\n\n    return useMemo(() => {\n        return mergeData(populationData, newDeaths, newCases)\n    }, [populationData, newDeaths, newCases])\n}\n","export const transpose = <T>(arr: Array<T>[]): Array<T>[] => arr[0].map((_, c) => arr.map((r) => r[c]))\n\nexport const last = <T>(arr: Array<T>): T | undefined => (arr.length > 0 ? arr[arr.length - 1] : undefined)\n","import { Integer } from '../types/Types'\n\nexport const toNumberOrZero = (s?: string): Integer => parseInt(s || '0')\n","// Copied from https://gist.github.com/gragland/a32d08580b7e0604ff02cb069826ca2f\nimport { useRef, useState, useCallback } from 'react'\n\nexport const useHover = () => {\n    const [value, setValue] = useState(false)\n\n    // Wrap in useCallback so we can use in dependencies below\n    const handleMouseOver = useCallback(() => setValue(true), [])\n    const handleMouseOut = useCallback(() => setValue(false), [])\n\n    // Keep track of the last node passed to callbackRef\n    // so we can remove its event listeners.\n    const ref = useRef()\n\n    // Use a callback ref instead of useEffect so that event listeners\n    // get changed in the case that the returned ref gets added to\n    // a different element later. With useEffect, changes to ref.current\n    // wouldn't cause a rerender and thus the effect would run again.\n    const callbackRef = useCallback(\n        (node) => {\n            if (ref.current) {\n                ref.current.removeEventListener('mouseover', handleMouseOver)\n                ref.current.removeEventListener('mouseout', handleMouseOut)\n            }\n\n            if (node) {\n                node.addEventListener('mouseover', handleMouseOver)\n                node.addEventListener('mouseout', handleMouseOut)\n            }\n        },\n        [handleMouseOver, handleMouseOut]\n    )\n\n    return [callbackRef, value]\n}\n","import React from 'react'\nimport './Minigraph.scss'\nimport { Integer, ISODate } from '../types/Types'\nimport { formatDateISO } from '../utils/date-util'\n\nconst MinigraphHover: React.FC<{\n    date: ISODate\n    value: Integer\n}> = ({ date, value }) => {\n    return (\n        <div className=\"minigraph-hover\">\n            <div className=\"value\">{value}</div>\n            <div className=\"date\">{formatDateISO(date)}</div>\n        </div>\n    )\n}\n\nexport default MinigraphHover\n","import { DateTime } from 'luxon'\nimport { ISODate } from '../types/Types'\n\nexport const formatDate = (date: DateTime): string => date.toFormat('LLL dd')\n\nexport const formatDateISO = (date: ISODate): string => formatDate(DateTime.fromISO(date))\n","import React from 'react'\nimport './Minigraph.scss'\nimport { Integer, ISODate } from '../types/Types'\nimport { useHover } from '../hooks/hover'\nimport MinigraphHover from './MinigraphHover'\n\nconst graphHeight = 40\n\nconst MinigraphBar: React.FC<{\n    date: ISODate\n    value: Integer\n    maxValue: Integer\n    barBorder: Integer\n}> = ({ date, value, maxValue, barBorder }) => {\n    const [barRef, isHovered] = useHover()\n    return (\n        <div\n            // @ts-ignore\n            ref={barRef}\n            key={date}\n            className=\"date\"\n            title={`${date}: ${value}`}\n            style={{ marginRight: barBorder }}\n        >\n            <div className={`bar ${isHovered ? 'hover' : ''}`} style={{ height: (value / maxValue) * graphHeight }} />\n            {isHovered && <MinigraphHover date={date} value={value} />}\n        </div>\n    )\n}\n\nexport default MinigraphBar\n","import React from 'react'\nimport { TimelineEntry } from '../types/Corona'\nimport './Minigraph.scss'\nimport MinigraphBar from './MinigraphBar'\n\nconst barBorder = 1\nconst barWidth = 3\n\nconst Minigraph: React.FC<{\n    timeline: TimelineEntry[]\n    graphClass: string\n    prefixText?: string\n}> = ({ timeline, prefixText, graphClass }) => {\n    const maxValue = Math.max(...timeline.map((v) => v.value)) || 0\n    const lastValue = timeline[timeline.length - 1]\n    const graphWidth = timeline.length * (barWidth + barBorder)\n\n    return (\n        <div className={`minigraph ${graphClass}`}>\n            <div className=\"bars\" style={{ width: graphWidth }}>\n                {timeline.map(({ date, value }) => (\n                    <MinigraphBar key={date} date={date} value={value} maxValue={maxValue} barBorder={barBorder} />\n                ))}\n            </div>\n            <div className=\"legend\">\n                {prefixText}\n                <span className=\"value\">{lastValue.value}</span>\n            </div>\n        </div>\n    )\n}\n\nexport default Minigraph\n","import React from 'react'\nimport './ProgressBar.scss'\nimport { Integer } from '../types/Types'\n\nconst ProgressBar: React.FC<{ width: Integer; progress: number }> = ({ width, progress }) => {\n    return (\n        <div className=\"progressbar\" style={{ width }}>\n            <div className=\"progress\" style={{ width: `${progress * 100}%` }} />\n        </div>\n    )\n}\n\nexport default ProgressBar\n","import React from 'react'\nimport { CountryData } from '../types/Corona'\nimport { formatCompact } from '../utils/number-util'\n\nconst CountryHover: React.FC<{ country: CountryData }> = ({ country }) => {\n    return (\n        <div className=\"country-hover\">\n            <span className=\"foo\">Population: {formatCompact(country.population)}</span>\n            {/*,{' '}<span className=\"foo\">Total deaths: {formatCompact(country.total)}</span>*/}\n        </div>\n    )\n}\n\nexport default CountryHover\n","import React, { useContext, useMemo } from 'react'\nimport Minigraph from './Minigraph'\nimport ProgressBar from './ProgressBar'\nimport { accumulateTotals, CountryData, TimelineEntry } from '../types/Corona'\nimport { useHover } from '../hooks/hover'\nimport CountryHover from './CountryHover'\nimport { PerCountryPageContext } from '../pages/PerCountryPage'\n\nconst PerCountryTableRow: React.FC<{ country: CountryData; maxDeathsPerCapita: number }> = ({\n    country,\n    maxDeathsPerCapita,\n}) => {\n    const [rowRef, isHovered] = useHover()\n    const searchProps = useContext(PerCountryPageContext)\n\n    const deathsTotal = useMemo<TimelineEntry[]>(() => accumulateTotals(country.deaths.values), [country])\n    const casesTotal = useMemo<TimelineEntry[]>(() => accumulateTotals(country.cases.values), [country])\n    const numCols = searchProps.numHistoryDays\n\n    return (\n        <tr\n            // @ts-ignore\n            ref={rowRef}\n            className={country.name === 'World' ? 'the-world' : ''}\n            title={`Total deaths: ${country.deaths.total}, per million: ${Math.round(\n                (country.deaths.totalPerCapita || 0) * 1e6\n            )}`}\n        >\n            <td className=\"country-name\">\n                {country.name}\n                {isHovered && <CountryHover country={country} />}\n            </td>\n            {searchProps.showCasesTotal && (\n                <td>\n                    <Minigraph timeline={casesTotal.slice(-numCols)} graphClass=\"cases\" />\n                </td>\n            )}\n            {searchProps.showCasesNew && (\n                <td>\n                    <Minigraph timeline={country.cases.values.slice(-numCols)} graphClass=\"cases\" prefixText={'+'} />\n                </td>\n            )}\n            <td className=\"deaths-per-capita prl\">\n                {country.population ? (\n                    <div className=\"deaths-per-capita-bar\">\n                        <ProgressBar width={100} progress={country.deaths.totalPerCapita / maxDeathsPerCapita} />\n                        <div className=\"progressbar-overlay\">{Math.round(country.deaths.totalPerCapita * 1e6)}</div>\n                    </div>\n                ) : (\n                    <div className=\"info-small\">No population data</div>\n                )}\n            </td>\n            {searchProps.showDeathsTotal && (\n                <td>\n                    <Minigraph timeline={deathsTotal.slice(-numCols)} graphClass=\"deaths\" />\n                </td>\n            )}\n            {searchProps.showDeathsNew && (\n                <td>\n                    <Minigraph timeline={country.deaths.values.slice(-numCols)} graphClass=\"deaths\" prefixText={'+'} />\n                </td>\n            )}\n        </tr>\n    )\n}\n\nexport default PerCountryTableRow\n","import React, { useCallback, useContext, useMemo } from 'react'\nimport { CountryData } from '../types/Corona'\nimport './PerCountryTable.scss'\nimport PerCountryTableRow from './PerCountryTableRow'\nimport { PerCountryPageContext } from '../pages/PerCountryPage'\n\nconst PerCountryTable: React.FC<{ countryData: CountryData[] }> = ({ countryData }) => {\n    const searchProps = useContext(PerCountryPageContext)\n\n    const countryFilter = useCallback(\n        (country: CountryData): boolean => {\n            if (searchProps.hideTinyCountries && (country.population || 0) < searchProps.tinyCountryLimit) {\n                return false\n            }\n            return true\n        },\n        [searchProps]\n    )\n\n    const countrySorter = useCallback(\n        (a: CountryData, b: CountryData): number => {\n            if (searchProps.showWorldFirst) {\n                if (a.name === 'World') {\n                    return Number.MIN_SAFE_INTEGER\n                }\n                if (b.name === 'World') {\n                    return Number.MAX_SAFE_INTEGER\n                }\n            }\n            return b.deaths.totalPerCapita - a.deaths.totalPerCapita\n        },\n        [searchProps]\n    )\n\n    const countries = useMemo(() => {\n        return [...countryData].sort(countrySorter).filter(countryFilter)\n    }, [countryData, countryFilter, countrySorter])\n\n    const maxDeathsPerCapita = useMemo(() => {\n        return Math.max(...countries.map((c) => c.deaths.totalPerCapita || 0))\n    }, [countries])\n\n    return (\n        <table className=\"countries mtl\">\n            <thead>\n                <tr>\n                    <th></th>\n                    {searchProps.showCasesTotal && <th className=\"align-center\">Cases</th>}\n                    {searchProps.showCasesNew && <th className=\"align-center\">Cases</th>}\n                    <th>Total Deaths</th>\n                    {searchProps.showDeathsTotal && <th className=\"align-center\">Deaths</th>}\n                    {searchProps.showDeathsNew && <th className=\"align-center\">Deaths</th>}\n                </tr>\n                <tr>\n                    <th>Location</th>\n                    {searchProps.showCasesTotal && <th className=\"align-center\">total</th>}\n                    {searchProps.showCasesNew && <th className=\"align-center\">new</th>}\n                    <th>per mill capita</th>\n                    {searchProps.showDeathsTotal && <th className=\"align-center\">total</th>}\n                    {searchProps.showDeathsNew && <th className=\"align-center\">new</th>}\n                </tr>\n            </thead>\n            <tbody>\n                {countries.map((country) => (\n                    <PerCountryTableRow key={country.name} country={country} maxDeathsPerCapita={maxDeathsPerCapita} />\n                ))}\n            </tbody>\n        </table>\n    )\n}\n\nexport default PerCountryTable\n","import React, { useContext } from 'react'\nimport { Button, Form, Slider, Switch } from 'antd'\nimport { PerCountryPageContext } from '../pages/PerCountryPage'\nimport './SearchPropsForm.scss'\nimport { formatCompact } from '../utils/number-util'\n\nexport const SearchPropsDefault = {\n    showWorldFirst: false,\n    hideTinyCountries: true,\n    tinyCountryLimit: 200000,\n    showDeathsNew: true,\n    showDeathsTotal: true,\n    showCasesNew: false,\n    showCasesTotal: false,\n    numHistoryDays: 30,\n}\n\nexport type SearchProps = typeof SearchPropsDefault\n\nconst SearchPropsForm: React.FC<{\n    updateSearchProps: (p: SearchProps) => void\n    onCloseDrawer?: () => void\n}> = ({ updateSearchProps, onCloseDrawer = () => {} }) => {\n    const searchProps = useContext(PerCountryPageContext)\n\n    const updateProp = (prop: keyof SearchProps) => (value: SearchProps[keyof SearchProps] | [number, number]): void =>\n        updateSearchProps({ ...searchProps, [prop]: value })\n\n    return (\n        <Form className=\"search-props-form\">\n            <Form.Item label=\"Show world first\">\n                <Switch checked={searchProps.showWorldFirst} onChange={updateProp('showWorldFirst')} />\n            </Form.Item>\n            <Form.Item label=\"Hide tiny countries\">\n                <Switch checked={searchProps.hideTinyCountries} onChange={updateProp('hideTinyCountries')} />\n            </Form.Item>\n            <div className=\"sub-item\">\n                <Form.Item label=\"Smaller than\">\n                    <Slider\n                        disabled={!searchProps.hideTinyCountries}\n                        min={0}\n                        max={1000000}\n                        value={searchProps.tinyCountryLimit}\n                        onChange={updateProp('tinyCountryLimit')}\n                        tipFormatter={formatCompact}\n                    />\n                </Form.Item>\n            </div>\n            <Form.Item label=\"Show new deaths\">\n                <Switch checked={searchProps.showDeathsNew} onChange={updateProp('showDeathsNew')} />\n            </Form.Item>\n            <Form.Item label=\"Show total deaths\">\n                <Switch checked={searchProps.showDeathsTotal} onChange={updateProp('showDeathsTotal')} />\n            </Form.Item>\n            <Form.Item label=\"Show new cases\">\n                <Switch checked={searchProps.showCasesNew} onChange={updateProp('showCasesNew')} />\n            </Form.Item>\n            <Form.Item label=\"Show total cases\">\n                <Switch checked={searchProps.showCasesTotal} onChange={updateProp('showCasesTotal')} />\n            </Form.Item>\n            <Form.Item label=\"Days of history\">\n                <Slider min={1} max={60} value={searchProps.numHistoryDays} onChange={updateProp('numHistoryDays')} />\n            </Form.Item>\n            <Button type=\"primary\" onClick={onCloseDrawer}>\n                Close\n            </Button>\n        </Form>\n    )\n}\n\nexport default SearchPropsForm\n","import React, { useState } from 'react'\nimport './PerCountryPage.scss'\nimport { usePageLoader } from './PerCountryPageLoader'\nimport PerCountryTable from '../components/PerCountryTable'\nimport { Button, Drawer } from 'antd'\nimport SearchPropsForm, { SearchProps, SearchPropsDefault } from '../components/SearchPropsForm'\nimport { last } from '../utils/array-util'\n\nexport const PerCountryPageContext = React.createContext(SearchPropsDefault)\n\nconst PerCountryPage = () => {\n    const countryData = usePageLoader()\n    const [drawerVisible, setDrawerVisible] = useState<boolean>(false)\n    const [searchProps, setSearchProps] = useState<SearchProps>(SearchPropsDefault)\n\n    const lastLoaded = countryData.length > 0 && last(countryData[0].deaths.values)?.date\n\n    const onCloseDrawer = () => setDrawerVisible(false)\n\n    return (\n        <PerCountryPageContext.Provider value={searchProps}>\n            <div className=\"per-country-page-header pll\">\n                <h1 className=\"mbs\">Coronavirus - deaths per capita</h1>\n                <div className=\"github-source mam\">\n                    <a href=\"https://github.com/trygvea/corona-stats\" target=\"_blank\" rel=\"noopener noreferrer\">\n                        Source on <img src=\"/corona-stats/GitHub-Mark-32px.png\" height={24} alt=\"github\"></img>\n                        <img src=\"/corona-stats/GitHub_Logo.png\" height={24} alt=\"github\"></img>\n                    </a>\n                </div>\n            </div>\n\n            <div className=\"per-country-page mll mtm\">\n                <p className=\"info-text\">\n                    There are many small countries that are hit much harder than the big countries. This graph shows\n                    coronavirus cases per country ordered per capita.\n                </p>\n\n                <p className=\"info-small mbxs\">\n                    Using data from{' '}\n                    <a href=\"https://ourworldindata.org/coronavirus-source-data\">\n                        ourworldindata.org/coronavirus-source-data\n                    </a>{' '}\n                    and{' '}\n                    <a href=\"https://datahub.io/JohnSnowLabs/population-figures-by-country\">datahub.io/JohnSnowLabs</a>.\n                    <br />\n                    New data from the day before are present every day at 13:00 CET, according to{' '}\n                    <a href=\"https://ourworldindata.org/coronavirus\">ourworldindata.org/coronavirus</a>\n                    <br />\n                    {lastLoaded && `This data was loaded ${lastLoaded}`}\n                </p>\n\n                <Button type=\"primary\" onClick={() => setDrawerVisible(true)}>\n                    Configure\n                </Button>\n                <Drawer\n                    title=\"Search details\"\n                    placement=\"left\"\n                    closable={true}\n                    onClose={onCloseDrawer}\n                    visible={drawerVisible}\n                    width={300}\n                >\n                    <SearchPropsForm updateSearchProps={setSearchProps} onCloseDrawer={onCloseDrawer} />\n                </Drawer>\n\n                <PerCountryTable countryData={countryData} />\n            </div>\n        </PerCountryPageContext.Provider>\n    )\n}\n\nexport default PerCountryPage\n","import React from 'react'\nimport './App.css'\nimport { BrowserRouter, Switch, Route } from 'react-router-dom'\nimport PerCountryPage from './pages/PerCountryPage'\n\nconst App = () => (\n    <BrowserRouter>\n        <Switch>\n            <Route path=\"/\">\n                <PerCountryPage />\n            </Route>\n        </Switch>\n    </BrowserRouter>\n)\n\nexport default App\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport './index.scss'\nimport App from './App'\nimport * as serviceWorker from './serviceWorker'\n\nReactDOM.render(\n    <React.StrictMode>\n        <App />\n    </React.StrictMode>,\n    document.getElementById('root')\n)\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister()\n"],"sourceRoot":""}